<!DOCTYPE html>
<html lang="ko">
<head>
    <link rel="icon" type="image/png" href="/favicon.png">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-GJ5X3ZYD2P"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6033803023329869"
     crossorigin="anonymous"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-GJ5X3ZYD2P');
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>서울 지반 위험 구간 지도 | 싱크홀 위험지역 정보</title>
    
    <!-- SEO 메타 태그 -->
    <meta name="description" content="서울시 내 지반 침하 위험 구간, 싱크홀 발생 지역, 침수 취약 지역 등 안전 정보를 제공하는 상세 지도입니다. 지역별, 위험 유형별로 검색 가능합니다.">
    <meta name="keywords" content="서울, 지반 침하, 싱크홀, 위험 구간, 침수 지역, 안전 지도, 위험 지역">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://example.com/seoul-sinkhole-map">
    
    <!-- Open Graph 태그 -->
    <meta property="og:title" content="서울 지반 위험 구간 및 싱크홀 지도">
    <meta property="og:description" content="서울시 내 지반 침하 위험 구간, 싱크홀 발생 지역 및 침수 취약 지역 정보를 확인하세요.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://example.com/seoul-sinkhole-map">
    <meta property="og:image" content="https://example.com/images/seoul-sinkhole-map.jpg">
    <meta property="og:site_name" content="서울 안전 정보">
    <meta property="og:locale" content="ko_KR">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="서울 지반 위험 구간 및 싱크홀 지도">
    <meta name="twitter:description" content="서울시 내 지반 침하 위험 구간, 싱크홀 발생 지역 및 침수 취약 지역 정보를 확인하세요.">
    <meta name="twitter:image" content="https://example.com/images/seoul-sinkhole-map.jpg">
    
    <!-- 리소스 사전 로드 -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js" as="script">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.3/leaflet.markercluster.js" as="script">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <!-- MarkerCluster CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.3/MarkerCluster.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.3/MarkerCluster.Default.css" />
    
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        .container {
            display: flex;
            height: 100%;
        }
        .sidebar {
            width: 350px;
            background-color: #f5f5f5;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            overflow-y: auto;
            z-index: 1000;
        }
        #map {
            flex: 1;
            height: 100%;
            z-index: 900;
        }
        h1 {
            margin-top: 0;
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 20px;
        }
        h2 {
            font-size: 1.2rem;
            color: #444;
            margin-bottom: 15px;
            margin-top: 25px;
        }
        .risk-item {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }
        .risk-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .region-name {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: #333;
        }
        .address {
            font-size: 0.9rem;
            color: #444;
            margin-bottom: 5px;
        }
        .length, .reason {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 3px;
        }
        .reason {
            color: #e74c3c;
        }
        .note {
            font-size: 0.85rem;
            color: #888;
            font-style: italic;
        }
        .highlight {
            background-color: #ffe7e7;
            border-left: 4px solid #ff4646;
        }
        .controls {
            margin-bottom: 20px;
        }
        .filter-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }
        input[type="text"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: white;
        }
        .zoom-controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        .btn {
            background-color: #3396ff;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        .btn:hover {
            background-color: #2980b9;
        }
        .legend {
            margin-top: 20px;
            padding: 10px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .legend-title {
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        .legend-color {
            width: 20px;
            height: 6px;
            margin-right: 8px;
            border-radius: 2px;
        }
        .legend-text {
            font-size: 0.85rem;
            color: #555;
        }
        .popup-content {
            font-size: 0.9rem;
            line-height: 1.4;
        }
        .popup-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        .popup-address {
            margin-bottom: 5px;
        }
        .popup-reason {
            color: #e74c3c;
            margin-bottom: 5px;
        }
        .popup-length {
            color: #666;
        }
        footer {
            background-color: #f0f0f0;
            padding: 15px;
            text-align: center;
            font-size: 0.85rem;
            color: #666;
            border-top: 1px solid #ddd;
        }
        .no-js-warning {
            background-color: #ffe7e7;
            color: #e74c3c;
            padding: 15px;
            margin: 15px;
            border-radius: 4px;
            text-align: center;
        }
        /* 모바일 대응 */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            .sidebar {
                width: auto;
                max-height: 40%;
            }
            #map {
                height: 60%;
            }
        }
    </style>
    
    <!-- 구조화된 데이터 추가 -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Map",
      "name": "서울 지반 위험 구간 및 싱크홀 지도",
      "description": "서울시 내 지반 침하 위험 구간, 싱크홀 발생 지역, 침수 취약 지역 등 안전 정보를 제공하는 상세 지도",
      "spatialCoverage": {
        "@type": "Place",
        "name": "서울특별시",
        "geo": {
          "@type": "GeoShape",
          "box": "37.4133 126.7341 37.7010 127.1823"
        }
      },
      "author": {
        "@type": "Organization",
        "name": "서울시 안전관리본부",
        "url": "https://example.com"
      },
      "datePublished": "2025-04-13",
      "dateModified": "2025-04-13"
    }
    </script>
<meta name="google-site-verification" content="bAFhaLdawECcG-cq3M5sbxTn1dvjK7wHvVn-SF-L9jw" />
</head>
<body>
   
    <div class="container">
        <nav class="sidebar" aria-label="위험구간 필터 및 목록">
            <section class="filter-section">
                <h2>구간 필터링</h2>
                <div class="controls">
                    <div class="filter-controls">
                        <label for="searchInput" class="sr-only">구간 검색</label>
                        <input type="text" id="searchInput" placeholder="구간 검색..." aria-label="구간 검색">
                        
                        <label for="regionFilter" class="sr-only">지역 필터</label>
                        <select id="regionFilter" aria-label="지역별 필터링">
                            <option value="">모든 지역</option>
                            <!-- 지역 옵션은 JavaScript로 동적 생성 -->
                        </select>
                        
                        <label for="reasonFilter" class="sr-only">선정사유 필터</label>
                        <select id="reasonFilter" aria-label="선정사유별 필터링">
                            <option value="">모든 선정사유</option>
                            <!-- 선정사유 옵션은 JavaScript로 동적 생성 -->
                        </select>
                    </div>
                    <div class="zoom-controls">
                        <button class="btn" id="zoomIn" aria-label="지도 확대">확대</button>
                        <button class="btn" id="zoomOut" aria-label="지도 축소">축소</button>
                        <button class="btn" id="resetView" aria-label="전체 지도 보기">전체보기</button>
                    </div>
                </div>
            </section>
            
            <section class="risk-list-section">
                <h2>위험 구간 목록</h2>
                <div id="riskList" aria-live="polite">
                    <!-- 위험 구간 목록이 여기에 동적으로 추가됩니다 -->
                </div>
            </section>
            
            <section class="legend-section">
                <h2>표시 설명</h2>
                <div class="legend">
                    <div class="legend-title">지도 범례</div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #ff0000;"></div>
                        <div class="legend-text">위험 구간</div>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #ff6b6b; height: 3px;"></div>
                        <div class="legend-text">주요 도로</div>
                    </div>
                </div>
            </section>
        </nav>
        
        <main id="map" aria-label="서울시 지반 위험 구간 지도"></main>
    </div>
    
    <noscript>
        <div class="no-js-warning">
            이 지도는 JavaScript가 활성화된 브라우저에서만 작동합니다. 지도를 보려면 JavaScript를 활성화해주세요.
        </div>
    </noscript>

    <footer>
        <p>© 2025 서울시 지반 위험 및 싱크홀 정보. 모든 권리 보유.</p>
        <p>이 지도는 서울시 지반 위험 구간, 싱크홀 발생 지역 및 침수 취약 지역에 대한 정보를 제공합니다.</p>
    </footer>

    <!-- Leaflet JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <!-- MarkerCluster JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.5.3/leaflet.markercluster.js"></script>
    
    <script>
        // 서울 지역구별 중심점 좌표 (대략적인 값)
        const districtCoordinates = {
            '강남구': [37.5172, 127.0473],
            '강동구': [37.5301, 127.1237],
            '강북구': [37.6396, 127.0257],
            '강서구': [37.5509, 126.8496],
            '관악구': [37.4784, 126.9516],
            '광진구': [37.5384, 127.0822],
            '구로구': [37.4952, 126.8872],
            '금천구': [37.4568, 126.8966],
            '노원구': [37.6542, 127.0568],
            '도봉구': [37.6688, 127.0471],
            '동대문구': [37.5744, 127.0395],
            '동작구': [37.5121, 126.9395],
            '마포구': [37.5665, 126.9018],
            '서대문구': [37.5791, 126.9368],
            '서초구': [37.4835, 127.0322],
            '성동구': [37.5635, 127.0367],
            '성북구': [37.6067, 127.0175],
            '송파구': [37.5145, 127.1060],
            '양천구': [37.5171, 126.8664],
            '영등포구': [37.5263, 126.8970],
            '용산구': [37.5320, 126.9901],
            '은평구': [37.6026, 126.9291],
            '종로구': [37.5997, 126.9866],
            '중구': [37.5636, 126.9975],
            '중랑구': [37.6066, 127.0927]
        };

        // 일부 주요 구간은 실제 좌표 지정 (핵심적인 위험 구간만)
        const specificCoordinates = {
            '언주로(압구정동 477 ~ 개포동 1282-5)': {
                path: [
                    [37.5328907147626, 127.030015846843], // 압구정동 시작점
                    [37.4775104738979, 127.056844754196]
                ]
            },
            '선릉로(구룡마을입구교차로 ~ 압구정동 507)': {
                path: [
                    [37.47602645016006, 127.05881042141522], // 구룡마을입구 근처
                    [37.5305907738308, 127.042239359947],
                ]
            },
            '서울특별시 고척동 76-368': {
                center: [37.5001182611958, 126.866428764433],
                radius: 100
            },
            '서울특별시 구로동 712-8': {
                center: [37.4869885923851, 126.882520625916],
                radius: 100
            },
            '구로구 고척동 76-74 ~ 구로구 고척동 77-5': {
                path: [
                    [37.4982471114362, 126.864659573327], // 구룡마을입구 근처
                    [37.5004997025243, 126.863084570466],
                ]
            },
            '구의1동 일대(구의동 640-6 등)': {
                center: [37.5410, 127.0862],
                radius: 1000
            },
            '자양1·2동 일대 등': {
                center: [37.5350, 127.0750], 
                radius: 800
            },
            '구의2동 일대(구의동 75-1 등)': {
                center: [37.5511217542213, 127.089562021017], 
                radius: 500
            },
            '능동·군자동 일대(군자동 49-1 등)': {
                center: [37.5564312412664, 127.076217028947], 
                radius: 800
            },
            '화양동 일대(화양동 37-82 등)': {
                center: [37.544096723139, 127.066104149882], 
                radius: 800
            },
            '광장동 188-2번지 일원': {
                center: [37.5473964463737, 127.109492483067], 
                radius: 50
            },
            '자양4동 43-44번지 전통시장 공영주차장': {
                center: [37.5366545382628, 127.064174229206], 
                radius: 30
            },
            '자양4동 72-1번지 일원': {
                center: [37.5320317499131, 127.066497515757], 
                radius: 30
            },
            '구의1동 252-95번지 일원': {
                center: [37.53933647429976, 127.08345869788346], 
                radius: 30
            },
            '구의1동 246-10번지 일원': {
                center: [37.537365912791, 127.08495308372], 
                radius: 30
            },
            '자양4동 57-153번지 일원': {
                center: [37.5340622077646, 127.063286905664], 
                radius: 30
            },
            '자양4동 8-8번지 일원': {
                center: [37.5340622077646, 127.063286905664], 
                radius: 200
            },
            '자양2동 680-63번지 일원': {
                center: [37.5407966413791, 127.066728885927], 
                radius: 100
            },
            '구의2동 63-7 외 2필지 일원': {
                center: [37.5472276222658, 127.089940298223], 
                radius: 100
            },
'화양동 111-117번지 일원': {center: [37.5464703832462, 127.074036482129], radius: 200},
'화양동 18-12번지 일원': {center: [37.5476778390111, 127.069085159421], radius: 500},
'중곡4동 93-13 외 6필지 일원': {center: [37.5537064363535, 127.08909930348], radius: 100},
'중곡1동 647-16 외 1필지 일원': {center: [37.5586799440836, 127.080038292072], radius: 60},
'구의3동 587-6 외 5필지 일원': {center: [37.5375506370719, 127.09120881117], radius: 170},
'중곡3동 695 외 2필지 일원': {center: [37.5684664162558, 127.080256698288], radius: 270},
'강변역 2번출구 와 테크노마트 사이': {path: [
                    [37.53480241004589, 127.09508748315403],
                    [37.53568947890658, 127.09560341217563],
                ]},
'자양동 621번지 일원': {center: [37.534785497976, 127.079444209496], radius: 140},
'가산동 343-8 ~ 가산동 481-11': {path:[[37.4694551385315, 126.883430714302], [37.4852525875044, 126.877432374989]]},
'가산동 535-155 ~ 가산동 459-5': {path: [
                    [37.4820385769622, 126.875171287864],
                    [37.4831521878148, 126.879918581982],
                ]},
'가산동 547-81 ~ 가산동 371-12': {path: [
                    [37.4785683814981, 126.876753417622],
                    [37.4795604660559, 126.88149347204],
                ]},
'가산동 557-4 ~ 가산동 356-5': {path: [
                    [37.471723910348, 126.881466617934],
                    [37.4724929309029, 126.884661951703],
                ]},
'가산동 680-1 ~ 가산동 505-3': {path: [
                    [37.4668308071783, 126.888325559629],
                    [37.48569445647, 126.879637722622],
                ]},
'가산동 327-18 ~ 가산동 569-21': {path: [
                    [37.4688869737023, 126.88593617005],
                    [37.4685228237935, 126.88458394821],
                ]},
'시흥동 911 ~ 시흥동 930-56': {path: [
                    [37.4508807407828, 126.908689481783],
                    [37.4463789820658, 126.909478104359],
                ]},
'광운로2나길': {center: [37.6175887470368, 127.060821575608], radius: 300},
'한글비석로20길 ~ 덕릉로83길': {path: [
                    [37.6608215939933, 127.074206790203],
                    [37.6599634859669, 127.074656316658],
                ]},
'고산16길 (서울시 마포구 대흥동 20-24 ~ 대흥동 22-45)': {path:[[37.5533253269801, 126.944653235021], [37.5524777270095, 126.94420401563]]},
'연남로1길 (서울시 마포구 연남동 564-37 ~ 연남동 567-34)': {path:[[37.5587693715216, 126.918713934096], [37.560635824263, 126.922385427924]]},
'성동구 도선동 35-2 ~ 성동구 마장동 470-1': {path:[[37.5617660022032, 127.035279680287], [37.5715272373727, 127.037532956109]]},
'성동구 행당동 286-3 ~ 성동구 행당동 128-22': {path:[[37.5621654183236, 127.033723255747], [37.5579786577264, 127.038741342677]]},
'성동구 성수동1가 670-27 ~ 성동구 성수동1가 656-292': {path:[[37.5505905972567, 127.043072681741], [37.54880803635, 127.043876247133]]},
'연건동 187-1 ~ 효제동 98': {path:[[37.5758276760027, 127.002644789621], [37.5738260176441, 127.003003340124]]},
'효제동 69-7 ~ 효제동 103': {path:[[37.5739880336787, 127.002228709376], [37.5744475214843, 127.003094832385]]},
'인사동 232 ~ 종로2가 9': {path:[[37.5710889450241, 126.985593867733], [37.5706057036739, 126.9852891232]]},
'종로2가 11-1 ~ 종로2가 25': {path:[[37.5704291697689, 126.985788578776], [37.5704772006117, 126.987447005655]]},
'종로2가 23 ~ 인사동 170': {path:[[37.5704480822611, 126.987295554224], [37.5727933430127, 126.986227570398]]},
'관훈동 192-13 ~ 견지동 95': {path:[[37.5737977065541, 126.984952174801], [37.5729063972347, 126.983277337106]]},
'효자동 25 ~ 효자동 150': {path:[[37.5816394624022, 126.971134196225], [37.5826270550798, 126.973099218409]]},
'소격동 73 ~ 재동 12': {path:[[37.5801742507333, 126.980245738543], [37.5795136784124, 126.984744416674]]},
'재동 25-4 ~ 재동 109': {path:[[37.5791615826754, 126.984843093762], [37.5773848329463, 126.985649824182]]}
        };

        // CSV 데이터를 직접 JavaScript 배열로 변환
        const riskData = [{'연번': 1,
  '시도': '서울특별시',
  '시군구': '강남구',
  '구간(주소)': '언주로(압구정동 477 ~ 개포동 1282-5)',
  '연장(m)': 6700,
  '선정사유': '지반침하사고 발생 빈도 높음',
  '비고': ''},
 {'연번': 2,
  '시도': '서울특별시',
  '시군구': '강남구',
  '구간(주소)': '선릉로(구룡마을입구교차로 ~ 압구정동 507)',
  '연장(m)': 6320,
  '선정사유': '지반침하사고 발생 빈도 높음',
  '비고': ''},
 {'연번': 3,
  '시도': '서울특별시',
  '시군구': '구로구',
  '구간(주소)': '서울특별시 고척동 76-368',
  '연장(m)': 80,
  '선정사유': '관로 구간 토사 유실로 인한 도로 침하',
  '비고': ''},
 {'연번': 4,
  '시도': '서울특별시',
  '시군구': '구로구',
  '구간(주소)': '서울특별시 구로동 712-8',
  '연장(m)': 30,
  '선정사유': '관로 구간 토사 유실로 인한 보도 침하',
  '비고': ''},
 {'연번': 5,
  '시도': '서울특별시',
  '시군구': '구로구',
  '구간(주소)': '구로구 고척동 76-74 ~ 구로구 고척동 77-5',
  '연장(m)': 290,
  '선정사유': '노후 하수관로 매설',
  '비고': ''},
 {'연번': 6,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '자양1·2동 일대 등',
  '연장(m)': 5029,
  '선정사유': '침수구간',
  '비고': ''},
 {'연번': 7,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '구의1동 일대(구의동 640-6 등)',
  '연장(m)': 4529,
  '선정사유': '침수구간',
  '비고': ''},
 {'연번': 8,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '구의2동 일대(구의동 75-1 등)',
  '연장(m)': 1354,
  '선정사유': '침수구간',
  '비고': ''},
 {'연번': 9,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '능동·군자동 일대(군자동 49-1 등)',
  '연장(m)': 2232,
  '선정사유': '침수구간',
  '비고': ''},
 {'연번': 10,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '화양동 일대(화양동 37-82 등)',
  '연장(m)': 1846,
  '선정사유': '침수구간',
  '비고': ''},
 {'연번': 11,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '광장동 188-2번지 일원',
  '연장(m)': 100,
  '선정사유': '지하개발 공사장 주변',
  '비고': ''},
 {'연번': 12,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '자양4동 43-44번지 전통시장 공영주차장',
  '연장(m)': 200,
  '선정사유': '',
  '비고': ''},
 {'연번': 13,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '자양4동 72-1번지 일원',
  '연장(m)': 70,
  '선정사유': '',
  '비고': ''},
 {'연번': 14,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '구의1동 252-95번지 일원',
  '연장(m)': 70,
  '선정사유': '',
  '비고': ''},
 {'연번': 15,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '구의1동 246-10번지 일원',
  '연장(m)': 100,
  '선정사유': '',
  '비고': ''},
 {'연번': 16,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '자양4동 57-153번지 일원',
  '연장(m)': 250,
  '선정사유': '',
  '비고': ''},
 {'연번': 17,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '자양4동 8-8번지 일원',
  '연장(m)': 200,
  '선정사유': '',
  '비고': ''},
 {'연번': 18,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '자양2동 680-63번지 일원',
  '연장(m)': 840,
  '선정사유': '지반침하 발생구간',
  '비고': ''},
 {'연번': 19,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '구의2동 63-7 외 2필지 일원',
  '연장(m)': 240,
  '선정사유': '',
  '비고': ''},
 {'연번': 20,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '화양동 111-117번지 일원',
  '연장(m)': 500,
  '선정사유': '',
  '비고': ''},
 {'연번': 21,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '화양동 18-12번지 일원',
  '연장(m)': 130,
  '선정사유': '',
  '비고': ''},
 {'연번': 22,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '중곡4동 93-13 외 6필지 일원',
  '연장(m)': 100,
  '선정사유': '',
  '비고': ''},
 {'연번': 23,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '중곡1동 647-16 외 1필지 일원',
  '연장(m)': 60,
  '선정사유': '',
  '비고': ''},
 {'연번': 24,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '구의3동 587-6 외 5필지 일원',
  '연장(m)': 170,
  '선정사유': '',
  '비고': ''},
 {'연번': 25,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '중곡3동 695 외 2필지 일원',
  '연장(m)': 270,
  '선정사유': '',
  '비고': ''},
 {'연번': 26,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '강변역 2번출구 와 테크노마트 사이',
  '연장(m)': 120,
  '선정사유': '지반침하 발생구간',
  '비고': ''},
 {'연번': 27,
  '시도': '서울특별시',
  '시군구': '광진구',
  '구간(주소)': '자양동 621번지 일원',
  '연장(m)': 140,
  '선정사유': '',
  '비고': ''},
 {'연번': 28,
  '시도': '서울특별시',
  '시군구': '금천구',
  '구간(주소)': '가산동 343-8 ~ 가산동 481-11',
  '연장(m)': 1967,
  '선정사유': '침수취약구간',
  '비고': ''},
 {'연번': 29,
  '시도': '서울특별시',
  '시군구': '금천구',
  '구간(주소)': '가산동 535-155 ~ 가산동 459-5',
  '연장(m)': 478,
  '선정사유': '침수취약구간',
  '비고': ''},
 {'연번': 30,
  '시도': '서울특별시',
  '시군구': '금천구',
  '구간(주소)': '가산동 547-81 ~ 가산동 371-12',
  '연장(m)': 478,
  '선정사유': '침수취약구간',
  '비고': ''},
 {'연번': 31,
  '시도': '서울특별시',
  '시군구': '금천구',
  '구간(주소)': '가산동 557-4 ~ 가산동 356-5',
  '연장(m)': 350,
  '선정사유': '침수취약구간',
  '비고': ''},
 {'연번': 32,
  '시도': '서울특별시',
  '시군구': '금천구',
  '구간(주소)': '가산동 680-1 ~ 가산동 505-3',
  '연장(m)': 2380,
  '선정사유': '침수취약구간',
  '비고': ''},
 {'연번': 33,
  '시도': '서울특별시',
  '시군구': '금천구',
  '구간(주소)': '가산동 327-18 ~ 가산동 569-21',
  '연장(m)': 250,
  '선정사유': '침수취약구간',
  '비고': ''},
 {'연번': 34,
  '시도': '서울특별시',
  '시군구': '금천구',
  '구간(주소)': '시흥동 911 ~ 시흥동 930-56',
  '연장(m)': 520,
  '선정사유': '지반침하 발생 이력',
  '비고': ''},
 {'연번': 35,
  '시도': '서울특별시',
  '시군구': '노원구',
  '구간(주소)': '광운로2나길',
  '연장(m)': 335,
  '선정사유': '잦은 지반침하 발생',
  '비고': ''},
 {'연번': 36,
  '시도': '서울특별시',
  '시군구': '노원구',
  '구간(주소)': '한글비석로20길 ~ 덕릉로83길',
  '연장(m)': 575,
  '선정사유': '잦은 지반침하 발생',
  '비고': ''},
 {'연번': 37,
  '시도': '서울특별시',
  '시군구': '마포구',
  '구간(주소)': '고산16길 (서울시 마포구 대흥동 20-24 ~ 대흥동 22-45)',
  '연장(m)': 125,
  '선정사유': '지반침하 다발 구역',
  '비고': ''},
 {'연번': 38,
  '시도': '서울특별시',
  '시군구': '마포구',
  '구간(주소)': '연남로1길 (서울시 마포구 연남동 564-37 ~ 연남동 567-34)',
  '연장(m)': 400,
  '선정사유': '장기사용 상수도관',
  '비고': ''},
 {'연번': 39,
  '시도': '서울특별시',
  '시군구': '성동구',
  '구간(주소)': '성동구 도선동 35-2 ~ 성동구 마장동 470-1',
  '연장(m)': 1150,
  '선정사유': '동북선 공사현장 복공판 제외',
  '비고': ''},
 {'연번': 40,
  '시도': '서울특별시',
  '시군구': '성동구',
  '구간(주소)': '성동구 행당동 286-3 ~ 성동구 행당동 128-22',
  '연장(m)': 640,
  '선정사유': '하수관거 공사완료 현장',
  '비고': ''},
 {'연번': 41,
  '시도': '서울특별시',
  '시군구': '성동구',
  '구간(주소)': '성동구 성수동1가 670-27 ~ 성동구 성수동1가 656-292',
  '연장(m)': 350,
  '선정사유': '재개발 공사장 주변',
  '비고': ''},
 {'연번': 42,
  '시도': '서울특별시',
  '시군구': '종로구',
  '구간(주소)': '연건동 187-1 ~ 효제동 98',
  '연장(m)': 290,
  '선정사유': '지하굴착 진행중인 굴착공사장 주변',
  '비고': ''},
 {'연번': 43,
  '시도': '서울특별시',
  '시군구': '종로구',
  '구간(주소)': '효제동 69-7 ~ 효제동 103',
  '연장(m)': 141,
  '선정사유': '',
  '비고': ''},
 {'연번': 44,
  '시도': '서울특별시',
  '시군구': '종로구',
  '구간(주소)': '인사동 232 ~ 종로2가 9',
  '연장(m)': 105,
  '선정사유': '지하굴착 진행중인 굴착공사장 주변',
  '비고': ''},
 {'연번': 45,
  '시도': '서울특별시',
  '시군구': '종로구',
  '구간(주소)': '종로2가 11-1 ~ 종로2가 25',
  '연장(m)': 155,
  '선정사유': '',
  '비고': ''},
 {'연번': 46,
  '시도': '서울특별시',
  '시군구': '종로구',
  '구간(주소)': '종로2가 23 ~ 인사동 170',
  '연장(m)': 305,
  '선정사유': '',
  '비고': ''},
 {'연번': 47,
  '시도': '서울특별시',
  '시군구': '종로구',
  '구간(주소)': '관훈동 192-13 ~ 견지동 95',
  '연장(m)': 200,
  '선정사유': '지하굴착 진행중인 굴착공사장 주변',
  '비고': ''},
 {'연번': 48,
  '시도': '서울특별시',
  '시군구': '종로구',
  '구간(주소)': '효자동 25 ~ 효자동 150',
  '연장(m)': 220,
  '선정사유': '노후 지하시설물 존재 및 공동 발견 구간',
  '비고': ''},
 {'연번': 49,
  '시도': '서울특별시',
  '시군구': '종로구',
  '구간(주소)': '소격동 73 ~ 재동 12',
  '연장(m)': 420,
  '선정사유': '노후 지하시설물 존재 및 공동 발견 구간',
  '비고': ''},
 {'연번': 50,
  '시도': '서울특별시',
  '시군구': '종로구',
  '구간(주소)': '재동 25-4 ~ 재동 109',
  '연장(m)': 220,
  '선정사유': '노후 지하시설물 존재 및 공동 발견 구간',
  '비고': ''}];

        let map;
        let markers = [];
        let polylines = [];
        let circles = [];
        let currentHighlight = null;
        let markerClusterGroup;

        function initMap() {
            // Leaflet 지도 초기화 - 서울 중심부로 설정
            map = L.map('map').setView([37.5665, 126.9780], 11);
            
            // OpenStreetMap 타일 레이어 추가
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                maxZoom: 19
            }).addTo(map);
            
            // 서울 경계 대략적으로 설정
            const seoulBounds = L.latLngBounds(
                L.latLng(37.4133, 126.7341), // 남서
                L.latLng(37.7010, 127.1823)  // 북동
            );
            map.fitBounds(seoulBounds);
            
            // Marker 클러스터링 설정
            markerClusterGroup = L.markerClusterGroup({
                disableClusteringAtZoom: 14,
                spiderfyOnMaxZoom: true,
                showCoverageOnHover: false
            });
            map.addLayer(markerClusterGroup);
            
            // 필터 옵션 설정
            setupFilterOptions();
            
            // 위험 구간 목록 생성
            createRiskList();
            
            // 지도에 위험 구간 표시
            renderRiskZones();
            
            // 이벤트 리스너 설정
            setupEventListeners();
        }

        function setupFilterOptions() {
            // 지역 필터 옵션 설정
            const regionFilter = document.getElementById('regionFilter');
            const regions = [...new Set(riskData.map(item => item['시군구']))].sort();
            
            regions.forEach(region => {
                const option = document.createElement('option');
                option.value = region;
                option.textContent = region;
                regionFilter.appendChild(option);
            });
            
            // 선정사유 필터 옵션 설정
            const reasonFilter = document.getElementById('reasonFilter');
            const reasons = [...new Set(riskData.map(item => item['선정사유']))].filter(Boolean).sort();
            
            reasons.forEach(reason => {
                const option = document.createElement('option');
                option.value = reason;
                option.textContent = reason;
                reasonFilter.appendChild(option);
            });
        }

        function createRiskList() {
            const riskListContainer = document.getElementById('riskList');
            riskListContainer.innerHTML = '';
            
            // 필터 적용
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const selectedRegion = document.getElementById('regionFilter').value;
            const selectedReason = document.getElementById('reasonFilter').value;
            
            const filteredData = riskData.filter(item => {
                const matchesSearch = !searchTerm || 
                    item['구간(주소)'].toLowerCase().includes(searchTerm) || 
                    item['시군구'].toLowerCase().includes(searchTerm) ||
                    (item['선정사유'] && item['선정사유'].toLowerCase().includes(searchTerm));
                
                const matchesRegion = !selectedRegion || item['시군구'] === selectedRegion;
                const matchesReason = !selectedReason || item['선정사유'] === selectedReason;
                
                return matchesSearch && matchesRegion && matchesReason;
            });
            
            filteredData.forEach((item, index) => {
                const riskItem = document.createElement('div');
                riskItem.className = 'risk-item';
                riskItem.dataset.index = index;
                riskItem.setAttribute('aria-label', `${item['시군구']} ${item['구간(주소)']} 위험구간`);
                
                // 비고 내용 처리
                const note = item['비고'] ? `<div class="note">${item['비고']}</div>` : '';
                // 선정사유 처리
                const reasonText = item['선정사유'] ? `<div class="reason">사유: ${item['선정사유']}</div>` : '';
                
                riskItem.innerHTML = `
                    <div class="region-name">${item['시군구']}</div>
                    <div class="address">${item['구간(주소)']}</div>
                    <div class="length">연장: ${item['연장(m)']}m</div>
                    ${reasonText}
                    ${note}
                `;
                
                riskItem.addEventListener('click', () => {
                    highlightRiskZone(item);
                });
                
                riskListContainer.appendChild(riskItem);
                // 5개마다 광고 삽입
                if ((index + 1) % 5 === 0) {
                    const adContainer = document.createElement('div');
                    adContainer.className = 'ad-container';
                    adContainer.style.margin = '15px 0';
                    adContainer.innerHTML = `
                        <ins class="adsbygoogle"
                             style="display:block"
                             data-ad-client="ca-pub-6033803023329869"
                             data-ad-slot="9804272559"
                             data-ad-format="auto"
                             data-full-width-responsive="true"></ins>
                    `;
                    riskListContainer.appendChild(adContainer);
                    // DOM에 추가된 후 AdSense 초기화
                    try {
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    } catch (e) {
                        console.log('AdSense 로드 중...');
                    }
                }
            });
        }

        function renderRiskZones() {
            // 이전 마커 및 폴리라인 제거
            clearMapLayers();
            
            riskData.forEach(item => {
                const address = item['구간(주소)'];
                const district = item['시군구'];
                
                // 특정 좌표가 있는 경우 (주요 구간)
                if (specificCoordinates[address]) {
                    const specificCoord = specificCoordinates[address];
                    
                    if (specificCoord.path) {
                        // 폴리라인으로 표시
                        const polyline = L.polyline(specificCoord.path, {
                            color: '#FF0000',
                            weight: 5,
                            opacity: 0.8,
                            smoothFactor: 1
                        }).addTo(map);
                        
                        polylines.push(polyline);
                        
                        // 팝업 추가
                        polyline.bindPopup(createPopupContent(item));
                        
                        // 폴리라인 클릭 이벤트
                        polyline.on('click', function() {
                            highlightRiskZone(item);
                        });
                    } else if (specificCoord.center && specificCoord.radius) {
                        // 원으로 표시 (영역)
                        const circle = L.circle(specificCoord.center, {
                            color: '#FF0000',
                            fillColor: '#FF0000',
                            fillOpacity: 0.3,
                            radius: specificCoord.radius
                        }).addTo(map);
                        
                        circles.push(circle);
                        
                        // 팝업 추가
                        circle.bindPopup(createPopupContent(item));
                        
                        // 원 클릭 이벤트
                        circle.on('click', function() {
                            highlightRiskZone(item);
                        });
                    }
                } else {
                    // 특정 좌표가 없는 경우, 구별 중심점 사용
                    if (districtCoordinates[district]) {
                        const marker = L.marker(districtCoordinates[district]);
                        marker.bindPopup(createPopupContent(item));
                        
                        marker.on('click', function() {
                            highlightRiskZone(item);
                        });
                        
                        markerClusterGroup.addLayer(marker);
                        markers.push(marker);
                    }
                }
            });
        }

        function createPopupContent(item) {
            // 선정사유 처리
            const reasonText = item['선정사유'] ? 
                `<div class="popup-reason">사유: ${item['선정사유']}</div>` : '';
            
            // 비고 처리
            const noteText = item['비고'] ? 
                `<div class="popup-note">비고: ${item['비고']}</div>` : '';
                
            return `
                <div class="popup-content">
                    <div class="popup-title">${item['시군구']}</div>
                    <div class="popup-address">${item['구간(주소)']}</div>
                    ${reasonText}
                    <div class="popup-length">연장: ${item['연장(m)']}m</div>
                    ${noteText}
                </div>
            `;
        }

        function highlightRiskZone(item) {
            // 사이드바 항목 하이라이트
            const riskItems = document.querySelectorAll('.risk-item');
            riskItems.forEach(riskItem => {
                if (riskItem.querySelector('.address').textContent === item['구간(주소)']) {
                    riskItem.classList.add('highlight');
                    // 스크롤 위치 조정
                    riskItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
                } else {
                    riskItem.classList.remove('highlight');
                }
            });
            
            const address = item['구간(주소)'];
            const district = item['시군구'];
            
            // 특정 좌표가 있는 경우
            if (specificCoordinates[address]) {
                const specificCoord = specificCoordinates[address];
                
                if (specificCoord.path) {
                    // 해당 폴리라인으로 지도 이동
                    const bounds = L.latLngBounds(specificCoord.path.map(point => L.latLng(point[0], point[1])));
                    map.fitBounds(bounds, { padding: [50, 50], maxZoom: 15 });
                    
                    // 폴리라인 강조
                    polylines.forEach(line => {
                        const linePath = line.getLatLngs();
                        const firstPoint = linePath[0];
                        const pathFirstPoint = L.latLng(specificCoord.path[0][0], specificCoord.path[0][1]);
                        
                        if (firstPoint.lat === pathFirstPoint.lat && firstPoint.lng === pathFirstPoint.lng) {
                            line.setStyle({
                                color: '#FF0000',
                                weight: 8,
                                opacity: 1
                            });
                            line.openPopup();
                        } else {
                            line.setStyle({
                                color: '#FF6B6B',
                                weight: 5,
                                opacity: 0.7
                            });
                        }
                    });
                } else if (specificCoord.center) {
                    // 원 중심으로 지도 이동
                    map.setView(specificCoord.center, 15);
                    
                    // 원 강조
                    circles.forEach(circle => {
                        const center = circle.getLatLng();
                        
                        if (center.lat === specificCoord.center[0] && center.lng === specificCoord.center[1]) {
                            circle.setStyle({
                                color: '#FF0000',
                                fillColor: '#FF0000',
                                fillOpacity: 0.5
                            });
                            circle.openPopup();
                        } else {
                            circle.setStyle({
                                color: '#FF6B6B',
                                fillColor: '#FF6B6B',
                                fillOpacity: 0.3
                            });
                        }
                    });
                }
            } else {
                // 지역구 중심점으로 이동
                if (districtCoordinates[district]) {
                    map.setView(districtCoordinates[district], 14);
                    
                    // 해당 마커 찾기 및 팝업 열기
                    markers.forEach(marker => {
                        const position = marker.getLatLng();
                        
                        if (position.lat === districtCoordinates[district][0] && 
                            position.lng === districtCoordinates[district][1]) {
                            marker.openPopup();
                        }
                    });
                }
            }
            
            currentHighlight = address;
        }

        function clearMapLayers() {
            // 마커 제거
            markerClusterGroup.clearLayers();
            markers = [];
            
            // 폴리라인 제거
            polylines.forEach(line => map.removeLayer(line));
            polylines = [];
            
            // 원 제거
            circles.forEach(circle => map.removeLayer(circle));
            circles = [];
        }

        function setupEventListeners() {
            // 검색 및 필터 이벤트
            document.getElementById('searchInput').addEventListener('input', () => {
                createRiskList();
            });
            
            document.getElementById('regionFilter').addEventListener('change', () => {
                createRiskList();
            });
            
            document.getElementById('reasonFilter').addEventListener('change', () => {
                createRiskList();
            });
            
            // 확대/축소 버튼
            document.getElementById('zoomIn').addEventListener('click', () => {
                map.zoomIn();
            });
            
            document.getElementById('zoomOut').addEventListener('click', () => {
                map.zoomOut();
            });
            
            // 전체보기 버튼
            document.getElementById('resetView').addEventListener('click', () => {
                // 서울 경계로 다시 이동
                const seoulBounds = L.latLngBounds(
                    L.latLng(37.4133, 126.7341),
                    L.latLng(37.7010, 127.1823)
                );
                map.fitBounds(seoulBounds);
                
                // 모든 하이라이트 리셋
                polylines.forEach(line => {
                    line.setStyle({
                        color: '#FF0000',
                        weight: 5,
                        opacity: 0.7
                    });
                });
                
                circles.forEach(circle => {
                    circle.setStyle({
                        color: '#FF0000',
                        fillColor: '#FF0000',
                        fillOpacity: 0.3
                    });
                });
                
                // 사이드바 하이라이트 제거
                document.querySelectorAll('.risk-item').forEach(item => {
                    item.classList.remove('highlight');
                });
                
                currentHighlight = null;
            });
        }

        // 페이지 로드 시 실행
        window.onload = initMap;
    </script>
    
    <!-- 추가 SEO 마크업 -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "서울시 안전 정보",
          "item": "https://example.com/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "지반 위험 지도",
          "item": "https://example.com/ground-risk-map/"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": "서울 지반 위험 구간 및 싱크홀 지도",
          "item": "https://example.com/seoul-sinkhole-map/"
        }
      ]
    }
    </script>
</body>
</html>
